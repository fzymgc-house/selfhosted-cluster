{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":dependencyDashboard",
    ":semanticCommits",
    ":automergeDigest",
    ":automergePatch",
    ":automergeMinor",
    "group:monorepos",
    "group:recommended",
    "workarounds:all"
  ],
  "schedule": [
    "before 4am on monday"
  ],
  "timezone": "America/New_York",
  "packageRules": [
    {
      "description": "Major version updates require manual review (no automerge)",
      "matchUpdateTypes": [
        "major"
      ],
      "enabled": true,
      "automerge": false,
      "minimumReleaseAge": "7 days",
      "prPriority": -1
    },
    {
      "description": "Auto-merge minor and patch updates for all dependencies",
      "matchUpdateTypes": [
        "minor",
        "patch"
      ],
      "groupName": "all non-major dependencies",
      "groupSlug": "all-minor-patch",
      "automerge": true,
      "automergeType": "pr",
      "platformAutomerge": true,
      "minimumReleaseAge": "3 days"
    },
    {
      "description": "HashiCorp Terraform providers",
      "matchManagers": [
        "terraform"
      ],
      "groupName": "hashicorp providers",
      "groupSlug": "hashicorp-providers",
      "automerge": true,
      "minimumReleaseAge": "3 days",
      "matchPackageNames": [
        "/^hashicorp//"
      ]
    },
    {
      "description": "Kubernetes core components - handle with care",
      "groupName": "kubernetes components",
      "groupSlug": "kubernetes-components",
      "schedule": [
        "before 4am on monday"
      ],
      "automerge": false,
      "minimumReleaseAge": "7 days",
      "matchPackageNames": [
        "/^kubernetes$/",
        "/^k3s$/",
        "/^kubectl$/"
      ]
    },
    {
      "description": "Core infrastructure components",
      "groupName": "core infrastructure components",
      "groupSlug": "core-infrastructure",
      "automerge": true,
      "minimumReleaseAge": "5 days",
      "matchPackageNames": [
        "/^cert-manager$/",
        "/^traefik$/",
        "/^metallb$/",
        "/^calico$/",
        "/^longhorn$/"
      ]
    },
    {
      "description": "Monitoring and observability stack",
      "groupName": "monitoring stack",
      "groupSlug": "monitoring-stack",
      "automerge": true,
      "minimumReleaseAge": "3 days",
      "matchPackageNames": [
        "/^grafana/",
        "/^victoriametrics/",
        "/^prometheus/",
        "/^loki$/",
        "/^alloy$/"
      ]
    },
    {
      "description": "Security and identity components",
      "groupName": "security components",
      "groupSlug": "security-components",
      "automerge": true,
      "minimumReleaseAge": "5 days",
      "matchPackageNames": [
        "/^vault$/",
        "/^authentik$/",
        "/^external-secrets$/"
      ]
    },
    {
      "description": "Terraform core and CLI",
      "matchManagers": [
        "terraform"
      ],
      "groupName": "terraform core",
      "groupSlug": "terraform-core",
      "automerge": false,
      "minimumReleaseAge": "7 days",
      "matchPackageNames": [
        "/^hashicorp/terraform$/"
      ]
    },
    {
      "description": "Container images from GitHub Container Registry",
      "matchManagers": [
        "kubernetes",
        "argocd",
        "kustomize"
      ],
      "groupName": "container images (ghcr)",
      "groupSlug": "container-images-ghcr",
      "automerge": true,
      "minimumReleaseAge": "2 days",
      "matchPackageNames": [
        "/^ghcr\\.io//"
      ]
    },
    {
      "description": "Docker Hub container images",
      "matchManagers": [
        "kubernetes",
        "argocd",
        "kustomize",
        "docker-compose"
      ],
      "groupName": "container images (docker hub)",
      "groupSlug": "container-images-docker",
      "automerge": true,
      "minimumReleaseAge": "2 days",
      "matchPackageNames": [
        "/^docker\\.io//",
        "/^library//",
        "/^[^/]+$/"
      ]
    },
    {
      "description": "Helm charts",
      "matchManagers": [
        "helm-values",
        "helmv3",
        "argocd"
      ],
      "groupName": "helm charts",
      "groupSlug": "helm-charts",
      "automerge": true,
      "minimumReleaseAge": "3 days"
    },
    {
      "description": "ArgoCD applications and manifests",
      "matchManagers": [
        "argocd",
        "kubernetes"
      ],
      "matchFileNames": [
        "argocd/**"
      ],
      "groupName": "argocd manifests",
      "groupSlug": "argocd-manifests",
      "automerge": true,
      "minimumReleaseAge": "2 days"
    },
    {
      "description": "Database and storage components",
      "groupName": "database components",
      "groupSlug": "database-components",
      "automerge": true,
      "minimumReleaseAge": "5 days",
      "matchPackageNames": [
        "/^postgres/",
        "/^postgresql/",
        "/^cnpg/",
        "/^redis$/"
      ]
    },
    {
      "description": "CI/CD and workflow components",
      "groupName": "ci/cd components",
      "groupSlug": "cicd-components",
      "automerge": true,
      "minimumReleaseAge": "3 days",
      "matchPackageNames": [
        "/^argo-workflows$/",
        "/^argo-events$/",
        "/^renovate$/"
      ]
    },
    {
      "description": "Ansible Galaxy collections",
      "matchManagers": [
        "ansible-galaxy"
      ],
      "groupName": "ansible collections",
      "groupSlug": "ansible-collections",
      "automerge": true,
      "minimumReleaseAge": "5 days"
    },
    {
      "description": "Python dependencies",
      "matchManagers": [
        "pip_requirements",
        "pep621"
      ],
      "groupName": "python dependencies",
      "groupSlug": "python-deps",
      "automerge": true,
      "minimumReleaseAge": "3 days"
    }
  ],
  "vulnerabilityAlerts": {
    "enabled": true,
    "schedule": [
      "at any time"
    ],
    "automerge": true,
    "minimumReleaseAge": null,
    "commitMessageSuffix": "[SECURITY]"
  },
  "osvVulnerabilityAlerts": true,
  "configMigration": true,
  "dependencyDashboard": true,
  "dependencyDashboardTitle": "ðŸ¤– Dependency Dashboard",
  "dependencyDashboardHeader": "This issue lists Renovate updates and detected dependencies. Read the [Dependency Dashboard](https://docs.renovatebot.com/key-concepts/dashboard/) docs to learn more.",
  "dependencyDashboardFooter": "- [ ] <!-- rebase-check -->If you want to rebase/retry any PRs, tick the checkbox above",
  "prConcurrentLimit": 10,
  "prHourlyLimit": 4,
  "labels": [
    "dependencies",
    "renovate"
  ],
  "assignees": [],
  "reviewers": [],
  "automerge": true,
  "automergeType": "pr",
  "platformAutomerge": true,
  "rebaseWhen": "auto",
  "rangeStrategy": "auto",
  "semanticCommits": "enabled",
  "semanticCommitType": "chore",
  "semanticCommitScope": "deps",
  "lockFileMaintenance": {
    "enabled": true,
    "schedule": [
      "before 4am on monday"
    ],
    "automerge": true,
    "platformAutomerge": true
  },
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update _VERSION variables in shell scripts and Makefiles",
      "managerFilePatterns": [
        "/\\.sh$/",
        "/Makefile$/",
        "/\\.mk$/"
      ],
      "matchStrings": [
        "# renovate: datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)\\s+\\w+_VERSION\\s*=\\s*[\"']?(?<currentValue>\\S+)[\"']?"
      ]
    }
  ],
  "argocd": {
    "managerFilePatterns": [
      "argocd/**/*.ya?ml$"
    ]
  },
  "helm-values": {
    "managerFilePatterns": [
      "argocd/**/values\\.ya?ml$"
    ]
  },
  "kustomize": {
    "managerFilePatterns": [
      "kustomization\\.ya?ml$"
    ]
  },
  "terraform": {
    "managerFilePatterns": [
      "\\.tf$"
    ]
  },
  "kubernetes": {
    "managerFilePatterns": [
      "\\.(yaml|yml)$"
    ],
    "ignorePaths": [
      "**/*.gotmpl"
    ]
  },
  "ansible-galaxy": {
    "managerFilePatterns": [
      "ansible/**/requirements\\.ya?ml$"
    ]
  },
  "pip_requirements": {
    "managerFilePatterns": [
      "requirements.*\\.txt$"
    ]
  },
  "pep621": {
    "managerFilePatterns": [
      "pyproject\\.toml$"
    ]
  },
  "ignoreDeps": [
    "k8s.gcr.io/kube-state-metrics/kube-state-metrics"
  ],
  "ignorePaths": [
    "**/node_modules/**",
    "**/bower_components/**",
    "**/vendor/**",
    "**/examples/**",
    "**/test/**",
    "**/tests/**",
    "**/__tests__/**"
  ],
  "prBodyTemplate": "{{{header}}}{{{table}}}{{{notes}}}{{{changelogs}}}",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{#if isMajor}}v{{newMajor}}{{else}}{{#if isSingleVersion}}v{{newVersion}}{{else}}{{newValue}}{{/if}}{{/if}}",
  "commitMessageSuffix": ""
}
