apiVersion: app.terraform.io/v1alpha2
kind: AgentPool
metadata:
  name: fzymgc-house-agents
  namespace: hcp-terraform
spec:
  name: fzymgc-house-k8s  # Must match agent pool name in HCP Terraform
  organization: fzymgc-house
  token:
    secretKeyRef:
      name: hcp-terraform-agent-token
      key: token
  agentTokens:
    - name: k8s-agent
  agentDeployment:
    replicas: 1  # Sequential execution - prevents concurrent Terraform state conflicts
    spec:
      containers:
        - name: tfc-agent
          image: hashicorp/tfc-agent:latest
          resources:
            requests:
              memory: "256Mi"
              cpu: "250m"
            limits:
              memory: "512Mi"
              cpu: "500m"
