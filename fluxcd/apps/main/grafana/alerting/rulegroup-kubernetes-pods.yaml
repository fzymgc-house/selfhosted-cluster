apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaRuleGroup
metadata:
  name: rg-kubernetes-pods
  namespace: grafana
  labels:
    grafana.integreatly.org/instance: grafana
spec:
  instanceSelector:
    matchLabels:
      dashboards: grafana
  folders:
    - title: Kubernetes
      interval: 1m
      orgId: 1
      rules:
        - title: Pod CrashLooping
          condition: A
          data:
            - refId: A
              datasourceUid: Prometheus
              relativeTimeRange:
                from: 300
                to: 0
              model:
                datasource:
                  type: prometheus
                  uid: Prometheus
                editorMode: code
                expr: rate(kube_pod_container_status_restarts_total[5m]) > 0
                intervalMs: 60000
                legendFormat: "{{namespace}}/{{pod}}"
                maxDataPoints: 43200
                refId: A
          for: 10m
          annotations:
            summary: "Pod restarting frequently"
          labels:
            severity: warning
          noDataState: NoData
          execErrState: Error


