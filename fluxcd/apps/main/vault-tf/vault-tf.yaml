apiVersion: infra.contrib.fluxcd.io/v1alpha2
kind: Terraform
metadata:
  name: vault-tf
  namespace: vault
spec:
  interval: 1m
  retryInterval: 1m
  path: ./vault
  approvePlan: ""
  sourceRef:
    kind: OCIRepository
    name: flux-system-tf
    namespace: flux-system
  runnerPodTemplate:
    volumes:
      - name: vault-cert
        configMap:
          name: fzymgc-ica1-ca
    volumeMounts:
      - name: vault-cert
        mountPath: /certs
        readOnly: true
    env:
      - name: VAULT_CACERT
        value: /certs/fullchain.crt
