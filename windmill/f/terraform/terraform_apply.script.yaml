summary: Apply Terraform changes using plan from S3
description: Downloads plan artifact from S3 and applies it, then cleans up the plan file
lock: '!inline f/terraform/terraform_apply.script.lock'
kind: script
schema:
  $schema: 'https://json-schema.org/draft/2020-12/schema'
  type: object
  properties:
    module_dir:
      type: string
      description: Path to the Terraform module directory
      default: null
      originalType: string
    vault_addr:
      type: string
      description: Vault server address
      default: 'https://vault.fzymgc.house'
      originalType: string
    vault_token:
      type: string
      description: Vault authentication token
      default: ''
      originalType: string
    tfc_token:
      type: string
      description: Terraform Cloud API token (optional)
      default: null
      originalType: string
    s3_resource:
      type: object
      description: S3 resource for retrieving plan artifacts
      default: null
      format: resource-s3
    plan_s3_key:
      type: string
      description: S3 key where plan file is stored
      default: ''
      originalType: string
  required:
    - module_dir
